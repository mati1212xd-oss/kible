<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Mapa toalet WUM</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background: #f9f9f9;
    }
    /* --- CSS dla nagłówka i tła zakładek --- */
    .header-container {
        background-color: #e8eef3; /* Jasny niebiesko-szary kolor tła */
        padding: 10px 10px 0 10px;
        border-radius: 10px 10px 0 0;
    }
    body > h2 {
        margin-top: 0; /* Usunięcie domyślnego marginesu h2 */
    }
    
    /* --- Istniejący CSS dla Mapy/Toalet --- */
    .map-container {
      position: relative;
      display: inline-block;
    }
    .map-container img {
      max-width: 100%;
      height: auto;
      border: 2px solid #ccc;
      border-radius: 10px;
    }
    .toilet {
      position: absolute;
      /* Zwiększony rozmiar dla łatwiejszego klikania na telefonie */
      width: 30px;
      height: 30px;
      background: blue;
      border-radius: 50%;
      cursor: pointer;
      transform: translate(-50%, -50%);
      border: 2px solid white;
      box-shadow: 0 0 5px rgba(0,0,0,0.4);
    }
    
    /* --- CSS dla Dymka (Tooltip) - ZMIENIONY --- */
    .tooltip {
      position: fixed;
      background: white;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      display: none;
      
      /* ZMIANA: Pozwalamy na zawijanie tekstu i ustawiamy maksymalną szerokość */
      white-space: normal;
      word-wrap: break-word; /* Dodatkowe zabezpieczenie łamania słów */
      max-width: 280px;      /* Maksymalna szerokość dymka */
      
      z-index: 10;
      /* Utrzymujemy stały rozmiar czcionki */
      font-size: 24px; 
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      text-align: left;
    }

    /* --- CSS dla Gwiazdek (Tylko wyświetlanie) --- */
    .rating-display {
        margin-top: 5px;
        text-align: center;
        /* Nadajemy kolor nieaktywnym gwiazdkom */
        color: #ccc;
    }
    .rating-display > span {
        display: inline-block;
        /* Rozmiar czcionki gwiazdek zostaje 20px, co jest nadal czytelne */
        font-size: 20px;
        width: 1.1em;
    }
    /* Klasa dla wypełnionych gwiazdek */
    .rating-display > span.selected {
        color: gold;
    }


    /* --- CSS dla Zakładek (Poprzednia zmiana) --- */
    .tab-buttons {
      margin: 20px 0 0 0;
      border-bottom: 1px solid #ccc;
      display: inline-block;
      margin-top: 0; /* Dopasowanie do nowego kontenera nagłówka */
    }
    .tab-link {
      background-color: #e9e9e9; 
      border: 1px solid #ccc;
      border-bottom: none;
      outline: none;
      cursor: pointer;
      padding: 14px 20px; 
      transition: 0.3s;
      font-size: 18px; 
      font-weight: 500;
      border-radius: 5px 5px 0 0;
      margin-right: -1px;
    }
    .tab-link:hover:not(.active) {
      background-color: #ddd;
    }
    .tab-link.active {
      background-color: white; 
      border-bottom: 1px solid white; /* Łączy się z tłem .tab-content */
      font-weight: 700; 
      border-top: 3px solid blue;
      padding-top: 11px;
    }
    .tab-content {
      display: none;
      padding: 20px;
      border: 1px solid #ccc;
      border-radius: 0 0 10px 10px;
      background-color: white;
      text-align: center;
      /* Dopasowanie do nowego tła nagłówka */
      border-top: none; 
      margin-top: -1px;
    }
    .tab-content.active {
      display: block;
    }
    .legend-list {
        text-align: left;
        display: inline-block;
        list-style-position: inside;
        padding-left: 0;
    }
    .legend-list li {
        margin-bottom: 5px;
    }
  </style>
</head>
<body>

<div class="header-container">
  <h2>Mapa toalet WUM – Kampusy</h2>

  <div class="tab-buttons">
    <button class="tab-link active" data-tab="banacha">Kampus Banacha</button>
    <button class="tab-link" data-tab="wolska">Wolska</button>
    <button class="tab-link" data-tab="lindleya">Lindleya</button>
    <button class="tab-link" data-tab="litewska">Litewska</button>
  </div>
</div>

<div id="banacha" class="tab-content active">
  <p>Kliknij w niebieskie kółko, aby zobaczyć informację o toalecie.</p>
  <div class="map-container" id="map">
    <img src="mapa_wum.png" alt="Mapa WUM">

    <div class="toilet" data-toilet-id="toilet_farmacja" data-rating="2"
         style="top: 8.64%; left: 78.39%;" 
         data-info="Farmacja (nr 9): Słabe, średniowieczne toalety w piwnicach"></div>

    <div class="toilet" data-toilet-id="toilet_11" data-rating="4"
         style="top: 20.64%; left: 76.17%;" 
         data-info="UCS (nr 11): Dużo toalet 1-osobowych nowoczesnych. Na ostatnim piętrze duże toalety wieloosobowe"></div>

    <div class="toilet" data-toilet-id="toilet_2" data-rating="0"
         style="top: 41.25%; left: 63.03%;" 
         data-info="CD (nr 2): Jedna na lewo od wejścia, druga na -1 przy windach. Słabe, dużo ludzi."></div>

    <div class="toilet" data-toilet-id="toilet_7a" data-rating="3"
         style="top: 25.80%; left: 39.17%;" 
         data-info="zaklad patomorfologii (nr 7): Dobra toaleta na 3 piętrze."></div>

    <div class="toilet" data-toilet-id="toilet_14" data-rating="4"
         style="top: 24.89%; left: 26.03%;" 
         data-info="CSM (nr 14): Duże toalety w szatniach w podziemiach, brak ludzi i brak zasięgu. Na 2 piętrze też spoko"></div>

    <div class="toilet" data-toilet-id="toilet_13" data-rating="5"
         style="top: 42.86%; left: 43.32%;" 
         data-info="CSR (nr 13): Fajne toalety, dużo ich na każdym piętrze, mało ludzi, ale otwarte"></div>
  </div>
</div>

<div id="wolska" class="tab-content">
  <h3>Szpital Wolska</h3>
  <div style="text-align: left; display: inline-block;">
      <p>Bardzo fajne toalety na 1 piętrze w budynku gdzie są sale seminaryjne, mało ludzi.</p>
      <p>Fajna toaleta na prawo za szatnią w budynku szpitala</p>
      <hr style="margin: 10px 0;">
      <div class="rating-display" style="text-align: left;"> <span class="selected">★</span><span class="selected">★</span><span class="selected">★</span><span class="selected">★</span><span class="selected">★</span>
      </div>
  </div>
</div>

<div id="lindleya" class="tab-content">
  <h3>Kampus Lindleya</h3>
  <div class="map-container">
    <img src="mapa-lindleya.png" alt="Mapa Kampusu Lindleya">
  </div>
</div>

<div id="litewska" class="tab-content">
  <h3>Kampus Litewska</h3>
  <div style="text-align: left; display: inline-block;">
    <p>Dobre, nowoczesne toalety na każdym piętrze, dosyć mało ludzi.</p>
    <hr style="margin: 10px 0;">
    <div class="rating-display" style="text-align: left;"> 
        <span class="selected">★</span>
        <span class="selected">★</span>
        <span class="selected">★</span>
        <span class="selected">★</span>
        <span>★</span>
    </div>
  </div>
</div>

<div class="tooltip" id="tooltip">
    <div id="tooltip-info"></div>
    <hr style="margin: 5px 0; border-top: 1px solid #eee;">
    <div style="font-weight: bold; text-align: center;">Ocena użytkownika:</div>
    <div class="rating-display" id="rating-display"></div>
</div>

<script>
  // --- ZMIENIONY SKRYPT DLA TOALET ---
  const toilets = document.querySelectorAll('.toilet');
  const tooltip = document.getElementById('tooltip');
  const tooltipInfo = document.getElementById('tooltip-info');
  const ratingDisplay = document.getElementById('rating-display');

  // Obsługa kliknięcia w toaletę
  toilets.forEach(t => {
    t.addEventListener('click', (e) => {
      const info = t.getAttribute('data-info');
      // Odczytaj hardkodowaną ocenę
      const rating = parseInt(t.getAttribute('data-rating')) || 0; 
      
      // 1. Zaktualizuj opis
      tooltipInfo.textContent = info;
      
      // 2. Wygeneruj gwiazdki na podstawie data-rating
      let starsHtml = '';
      const totalStars = 5;
      
      for (let i = 1; i <= totalStars; i++) {
        // Klasa 'selected' jest dodawana, jeśli numer gwiazdki (i) jest mniejszy lub równy ocenie (rating)
        const starClass = i <= rating ? 'selected' : '';
        starsHtml += `<span class="${starClass}">★</span>`;
      }
      
      ratingDisplay.innerHTML = starsHtml;

      // 3. Pokaż dymek (najpierw ustaw display: block, żeby móc zmierzyć jego szerokość)
      tooltip.style.display = 'block';

      // 4. Inteligentne pozycjonowanie dymka 
      
      const tooltipWidth = tooltip.offsetWidth; // Szerokość dymka
      const windowWidth = window.innerWidth;   // Szerokość okna przeglądarki
      const clickX = e.clientX;                // Pozycja X kliknięcia

      let newLeft = clickX + 10; // Domyślna pozycja (na prawo od kliknięcia)

      // Sprawdź, czy dymek wykracza poza prawą krawędź okna
      if (newLeft + tooltipWidth + 10 > windowWidth) {
        // Jeśli tak, przesuń go na lewo od kliknięcia
        newLeft = clickX - tooltipWidth - 10; 
        
        // Dodatkowe sprawdzenie, czy nie wychodzi poza lewą krawędź
        if (newLeft < 10) {
            newLeft = 10; // Ustaw stałą pozycję od lewej
        }
      }
      
      // Ustaw nową pozycję
      tooltip.style.top = (e.clientY - 40) + 'px'; 
      tooltip.style.left = newLeft + 'px';
    });
  });

  document.addEventListener('click', (e) => {
    // Ukrywa tooltip, jeśli kliknięto poza kółkiem toalety i poza samym tooltipem
    if (!e.target.classList.contains('toilet') && !tooltip.contains(e.target)) {
      tooltip.style.display = 'none';
    }
  });

  // --- SKRYPT DLA ZAKŁADEK (bez zmian) ---
  const tabButtons = document.querySelectorAll('.tab-link');
  const tabContents = document.querySelectorAll('.tab-content');

  tabButtons.forEach(button => {
    button.addEventListener('click', () => {
      tabButtons.forEach(btn => btn.classList.remove('active'));
      tabContents.forEach(content => content.classList.remove('active'));
      
      const tabId = button.getAttribute('data-tab');
      document.getElementById(tabId).classList.add('active');
      button.classList.add('active');
      
      tooltip.style.display = 'none';
    });
  });
</script>

</body>
</html>
